<!DOCTYPE html>
<html lang="en-us" class="han-init"><head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title>
    
      双选择 oddball 任务数据分析：基于 R
    
  </title>


  <link rel="shortcut icon" type="image/x-icon" href="/" />
  
  
  
  <link rel="stylesheet" href="/css/main.css" />
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/han-css@3/dist/han.min.css">
</head>
<body a="auto">
        <main class="page-content" aria-label="Content">
            <div class="w">
<a href="/">..</a>

<article>
    <p class="post-meta">
        <time datetime="2021-08-26 00:00:00 &#43;0000 UTC">
            2021-08-26
        </time>
    </p>

    <h1>双选择 oddball 任务数据分析：基于 R</h1>

    


<blockquote>
<p>不打无准备的仗</p>
</blockquote>
<div id="引言" class="section level1">
<h1>引言</h1>
<p>因为疫情原因，没有收集数据。但是研究的进度不能耽误。就想到利用预实验的数据提前写好数据分析程序。</p>
<p>这样做有以下几点合理性：</p>
<ul>
<li>R 数据分析是代码形式的分析，可重复利用；</li>
<li>预实验数据在内容和排列方式上与正式实验一致，写好后，可以直接用在正式实验数据上；</li>
</ul>
<p>有以下几点优势：</p>
<ul>
<li>根据数据分析情况，可适时调整实验程序收集的数据格式和项目；可编辑；</li>
<li>收数据时，可以立马导入，查看结果；响应速度快；</li>
<li>可以此判断变量的数量和内容，即收集哪些变量。</li>
</ul>
<p>因此，准备花两天时间把代码写出来，并在博客中记录经验。</p>
</div>
<div id="材料" class="section level1">
<h1>材料</h1>
<p>被试间平衡反应方式与刺激类型的对应关系；</p>
<p>反应时代价和准确率代价为分析指标，代价越小，行为抑制控制能力越强。</p>
<p>2 × 2 区组实验设计（被试内）</p>
<p>组间变量是<code>Type</code>，组内变量是<code>SessionNumber</code>。前者指被试分组，后者指前后测。</p>
<p>采用重复测量方差分析，检验前后测差异，以及两组被试间的差异。</p>
<p>重复测量方差分析的基本假设是正态性和方差齐性，需要在方差分析前进行检验。</p>
</div>
<div id="加载包" class="section level1">
<h1>加载包</h1>
<pre class="r"><code>library(tidyverse)</code></pre>
</div>
<div id="导入数据" class="section level1">
<h1>导入数据</h1>
<p>按照被试编号（主）、实验序号（次）、试次（再次）进行排序</p>
<pre class="r"><code>oddballfiles &lt;- list.files(path = &quot;~/GitHub/Station/exp_TwoChoice_oddball_xiaoyu/TwoChoice_oddball_Data/&quot;, pattern = &quot;.csv&quot;, full.names = TRUE)
data_oddball &lt;- map_df(oddballfiles, read_csv)</code></pre>
<p>被试类型应该单独一个文件，几个任务数据共用</p>
<pre class="r"><code>participant_type &lt;- read_csv(&quot;~/GitHub/Station/exp_TwoChoice_oddball_xiaoyu/ParticipantType/ParticipantType.csv&quot;)</code></pre>
</div>
<div id="预处理" class="section level1">
<h1>预处理</h1>
<p>提取正式实验数据</p>
<pre class="r"><code>oddball_filted &lt;- data_oddball %&gt;% filter(is.na(PracticeNum) == TRUE)</code></pre>
<p>剔除反应时低于 300 ms 的试次</p>
<pre class="r"><code>oddball_filted &lt;- oddball_filted %&gt;% filter(RT &gt; 0.300)</code></pre>
<p>剔除反应时大于 3000 的试次</p>
<pre class="r"><code>oddball_filted &lt;- oddball_filted %&gt;% filter(RT &lt; 3.000)</code></pre>
<p>计算每个被试的平均反应时和准确率</p>
<pre class="r"><code>oddball_ave &lt;- oddball_filted %&gt;%
  group_by(ParticipantID, SessionNumber, WordNum) %&gt;%
  summarise(
    RT = mean(RT),
    ACC = mean(ACC),
    .groups = &quot;drop&quot;
  )</code></pre>
<p>计算反应时代价和准确率代价</p>
<pre class="r"><code>oddball_wide &lt;- oddball_ave %&gt;%
  pivot_wider(
    names_from = WordNum,
    values_from = c(RT, ACC)
  )</code></pre>
<pre class="r"><code>oddball_cost &lt;- oddball_wide %&gt;%
  transmute(
    ParticipantID = ParticipantID,
    SessionNumber = SessionNumber,
    RT_cost = 1000 * (RT_2 - RT_1),
    ACC_cost = ACC_1 - ACC_2
  )</code></pre>
<p>增加被试类型信息</p>
<pre class="r"><code>oddball_cost &lt;- oddball_cost %&gt;% left_join(., participant_type, by = &quot;ParticipantID&quot;)</code></pre>
</div>
<div id="重复测量方差分析" class="section level1">
<h1>重复测量方差分析</h1>
<p>方差分析有</p>
<ul>
<li>单因素组间方差分析</li>
<li>单因素组内方差分析（重复测量）</li>
<li>含组间和组内因子的双因素方差分析（混合模型方差）</li>
</ul>
<p>也可以按照是否区组设设计</p>
<ul>
<li>完全随机设计（因素组间方差分析）</li>
<li>随机区组设计（混合模型方差分析）</li>
</ul>
<p>我们在这里进行的是混合模型方差分析。表达式为：</p>
<pre><code># 单个组内因子（W）
# 单个组间因子（B）
aov(y ~ B + W + Error(Subject / W), data = DATA)</code></pre>
<p>方差齐次性检验</p>
<p>重复测量方差分析</p>
<pre class="r"><code># 反应时代价
oddball_rt_aov &lt;- oddball_cost %&gt;%
  aov(RT_cost ~ Type * SessionNumber + Error(ParticipantID / SessionNumber), data =  .)
oddball_rt_aov %&gt;% summary()</code></pre>
<pre class="r"><code># 准确率代价
oddball_acc_aov &lt;- oddball_cost %&gt;%
  aov(ACC_cost ~ Type * SessionNumber + Error(ParticipantID / SessionNumber), data =  .)
oddball_acc_aov %&gt;% summary()</code></pre>
<p>结果解读</p>
<ul>
<li>Type 对 反应时代价的影响；</li>
<li>控制 Type 是，反应时代价的前后测差异；</li>
<li>控制两因素主效应时，组别和时间的交互效应。</li>
</ul>
<p>事后检验</p>
</div>
<div id="描述性统计" class="section level1">
<h1>描述性统计</h1>
<p>既反映总体平均值大小，又反映被试分布。还有置信区间（误差bar）</p>
<p>计算均值和标准差</p>
</div>
<div id="可视化" class="section level1">
<h1>可视化</h1>
<p>折线图：展示交互作用</p>
<pre class="r"><code># 反应时代价
with(oddball_cost,
  interaction.plot(Type, SessionNumber, RT_cost,
    type = &quot;b&quot;, col = c(&quot;red&quot;, &quot;blue&quot;), pch = c(16, 18),
    main = &quot;Interaction plot&quot;,
    ylab = &quot;RT Cost (ms)&quot;)
  )</code></pre>
<pre class="r"><code># 准确率代价
with(oddball_cost,
  interaction.plot(Type, SessionNumber, ACC_cost,
    type = &quot;b&quot;, col = c(&quot;red&quot;, &quot;blue&quot;), pch = c(16, 18),
    main = &quot;时间与分组的交互作用图&quot;,
    ylab = &quot;ACC Cost&quot;)
  )</code></pre>
<p>箱线图</p>
<pre class="r"><code># 反应时代价
oddball_cost %&gt;% boxplot(RT_cost ~ Type * SessionNumber,
  data = .,
  col = c(&quot;red&quot;, &quot;green&quot;),
  main = &quot;箱线图：反应时代价&quot;,
  ylab = &quot;RT Cost (ms)&quot;)</code></pre>
</div>

</article>

            </div>
        </main>
	<script src="https://cdn.jsdelivr.net/npm/han-css@3/dist/han.min.js"></script>
    </body></html>
